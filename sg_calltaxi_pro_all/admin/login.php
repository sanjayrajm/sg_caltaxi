<?php require_once __DIR__ . '/../database/db.php'; session_start(); $err=''; if ($_SERVER['REQUEST_METHOD']==='POST') { $email=$_POST['email']??''; $pass=$_POST['password']??''; $stmt=$pdo->prepare('SELECT * FROM users WHERE email=? LIMIT 1'); $stmt->execute([$email]); $u=$stmt->fetch(PDO::FETCH_ASSOC); if ($u && (password_verify($pass,$u['password']) || hash('sha256',$pass)==$u['password'])){ $_SESSION['user']=['id'=>$u['id'],'name'=>$u['name'],'role'=>$u['role']]; header('Location: tariffs.php'); exit;} else $err='Invalid'; } ?>
<!doctype html><html><head><meta charset='utf-8'><title>Admin Login</title><link href='/public/css/bootstrap.min.css' rel='stylesheet'></head><body><div class='container py-5'><div style='max-width:420px;margin:0 auto' class='card p-3'><h4>Admin Login</h4><?php if($err): ?><div class='alert alert-danger'><?=htmlspecialchars($err)?></div><?php endif; ?><form method='post'><input class='form-control mb-2' name='email' placeholder='Email' required><input class='form-control mb-2' name='password' type='password' placeholder='Password' required><button class='btn btn-primary'>Login</button></form></div></div></body></html>